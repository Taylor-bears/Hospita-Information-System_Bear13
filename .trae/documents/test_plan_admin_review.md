# 管理员审核测试计划

## 目标
- 覆盖单元与集成测试，确保审核流程与审计日志完整，权限控制生效。

## 范围
- 端点：查询、详情、通过、拒绝、批量处理、审计日志查询
- 权限：管理员、只读审核员、普通用户

## 用例
- 查询
  - 待审核集合分页返回正确
  - 角色过滤与状态过滤组合
  - 空数据返回 `items=[] total=0`
- 详情
  - 存在返回 200；不存在返回 404
- 审核通过
  - 单条通过：状态由 `pending`→`approved`，用户标记更新，审计日志记录
  - 已通过再次通过：返回 409
- 审核拒绝
  - 单条拒绝：需填写 `reason`，状态更新，审计日志记录
  - 已拒绝再次拒绝：返回 409
- 批量处理
  - 混合 ID：部分成功、部分失败的返回结构
  - 大批量分页的边界测试
- 权限
  - 未登录：401
  - 非管理员：403
  - 具备 `review:read` 但无 `review:write` 的用户：可查不可改
- 性能
  - P95 响应时间 <500ms；并发 100 下无错误与超时

## 数据一致性
- 事务：审核更新与审计日志写入原子性
- 幂等：重复提交不改变最终状态，返回 409 或 200 with same state

## 模拟与工具
- 模拟管理员/审核员/普通用户的 JWT
- 预置数据：`reviews` 1000 条；`users` 10000 条
- 压测：`k6` 或 `locust` 脚本

## 报告
- 统计通过率、失败用例、平均与 P95 响应时间、错误码分布
- 列出所有失败原因与修复建议
