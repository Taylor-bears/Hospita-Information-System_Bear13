## 问题判断
- 登录/注册返回 404 与 400：后端 `FastAPI` 路由对无尾斜杠和有尾斜杠区分；前端偶发请求路径不一致；错误信息未透出后端 `detail`，前端仅显示通用“请求失败”导致难以定位。
- 患者注册 400：常见为手机号重复或手机号长度校验失败；前端校验通过但未清晰提示后端原因。

## 解决方案
### 1. 统一前端请求路径，避免 404
- 在 `src/stores/authStore.ts` 将所有 `login/register` 请求路径统一为无尾斜杠（`/api/auth/login`、`/api/auth/register/patient|doctor|pharmacist`）。
- 保留后端两种路径支持（`/path` 与 `/path/`），彻底避免路径差异引发的 404。

### 2. 明确错误提示，透出后端原因
- 在 `authStore` 的 `login` 与 `register` 捕获错误时，优先显示 `error.response?.data?.detail`；无则显示 `error.message`。
- 在 `RegisterPage.tsx` 成功后提示语保持，失败时同样显示后端 `detail`。

### 3. 输入清洗与校验一致
- 登录/注册前：统一在 `authStore` 使用 `sanitizePhone` 清洗成 11 位纯数字；与后端 `_validate_phone_or_raise` 一致，避免 422。
- 表单校验与后端一致：`LoginPage.tsx` 和 `RegisterPage.tsx` 已设定最少 5 位密码与手机号正则，无需额外调整。

### 4. 验证流程
- 使用默认管理员账号 `13800138000 / admin` 验证登录无 404。
- 注册新患者：手机号为未使用的 11 位（例如 `13512345678`），密码长度 ≥ 5，确认成功；重复手机号应看到“该手机号已被注册”。
- 患者登录：使用刚注册的手机号与密码，角色选“患者”；校验后端将 `patient` 映射为 `user` 并返回 token 与 `user_id`，随后 `GET /api/profile/me?user_id=...` 正常。

### 5. 可选加固（如再现 404）
- 若仍发生 404，暂时在前端 Axios 实例加入重试一次无尾斜杠/有尾斜杠的容错逻辑，仅对 `login/register` 生效，并记录 console 警告，后续清理。
- 排查是否存在旧的本地 Dev 服务器路由（`medical-system/frontend/server.js`）影响请求；如有，关闭或删除以避免冲突。

## 交付变更
- 更新 `src/stores/authStore.ts` 的请求路径为无尾斜杠，并改进错误处理（显示后端 `detail`）。
- 保持后端路由同时接受两种路径（无须用户操作）。

## 预期结果
- 患者正常注册与登录不再出现 404；错误原因（手机号重复、格式错误）在前端清晰展示。
- 管理员、医生、药师登录/注册路径同样稳定，减少环境差异造成的失败。

请确认，我将立即实施上述改动并在你的环境中逐页验证登录与注册流程。